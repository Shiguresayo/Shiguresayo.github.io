<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>スロット風リール（高速→減速→停止）</title>
<style>
  .reel-container {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin: 50px;
  }
  .reel-wrapper {
    width: 100px;
    height: 100px;
    overflow: hidden;
    border: 2px solid #333;
    border-radius: 8px;
  }
  .reel-inner {
    display: flex;
    flex-direction: column;
  }
  .reel-inner img {
    width: 100px;
    height: 100px;
  }
  #startBtn {
    display: block;
    margin: 20px auto;
    padding: 10px 20px;
    font-size: 16px;
  }
  #result {
    text-align: center;
    font-size: 24px;
    margin-top: 20px;
    font-weight: bold;
  }
</style>
</head>
<body>

<div class="reel-container">
  <div class="reel-wrapper">
    <div class="reel-inner">
      <img src="pamo1.jpg">
      <img src="pamo2.jpg">
      <img src="pamo3.jpg">
    </div>
  </div>
  <div class="reel-wrapper">
    <div class="reel-inner">
      <img src="pamo1.jpg">
      <img src="pamo2.jpg">
      <img src="pamo3.jpg">
    </div>
  </div>
  <div class="reel-wrapper">
    <div class="reel-inner">
      <img src="pamo1.jpg">
      <img src="pamo2.jpg">
      <img src="pamo3.jpg">
    </div>
  </div>
</div>

<button id="startBtn">スタート</button>
<div id="result"></div>

<script>
const images = ["pamo1.jpg","pamo2.jpg","pamo3.jpg"];
const reelInners = document.querySelectorAll(".reel-inner");
const btn = document.getElementById("startBtn");
const resultDiv = document.getElementById("result");

// 前回位置保持
let positions = [0,0,0]; // px単位

btn.addEventListener("click", () => {
    btn.disabled = true;
    resultDiv.textContent = "";

    const baseSpeed = 10;  // 高速回転(px/frame)
    const stopDelays = [0, 15, 30]; // 左→右順に減速開始
    const decelerationFrames = 30; // 減速期間フレーム数

    let frame = 0;
    let speeds = [baseSpeed, baseSpeed, baseSpeed];

    function animate() {
        reelInners.forEach((inner, i) => {
            // 減速判定
            if(frame >= stopDelays[i]){
                const t = Math.min((frame - stopDelays[i])/decelerationFrames, 1); // 0→1
                speeds[i] = baseSpeed * (1 - t*t); // 二次イージングで滑らか減速
            }

            positions[i] += speeds[i];
            positions[i] %= images.length
