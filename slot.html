<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ã‚¹ãƒ­ãƒƒãƒˆé¢¨ãƒªãƒ¼ãƒ«ï¼ˆæ»‘ã‚‰ã‹æ¸›é€Ÿï¼‰</title>
<style>
  .reel-container {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin: 50px;
  }
  .reel-wrapper {
    width: 100px;
    height: 100px;
    overflow: hidden;
    border: 2px solid #333;
    border-radius: 8px;
  }
  .reel-inner {
    display: flex;
    flex-direction: column;
  }
  .reel-inner img {
    width: 100px;
    height: 100px;
  }
  #startBtn {
    display: block;
    margin: 20px auto;
    padding: 10px 20px;
    font-size: 16px;
  }
  #result {
    text-align: center;
    font-size: 24px;
    margin-top: 20px;
    font-weight: bold;
  }
</style>
</head>
<body>

<div class="reel-container">
  <div class="reel-wrapper">
    <div class="reel-inner">
      <img src="pamo1.jpg">
      <img src="pamo2.jpg">
      <img src="pamo3.jpg">
    </div>
  </div>
  <div class="reel-wrapper">
    <div class="reel-inner">
      <img src="pamo1.jpg">
      <img src="pamo2.jpg">
      <img src="pamo3.jpg">
    </div>
  </div>
  <div class="reel-wrapper">
    <div class="reel-inner">
      <img src="pamo1.jpg">
      <img src="pamo2.jpg">
      <img src="pamo3.jpg">
    </div>
  </div>
</div>

<button id="startBtn">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
<div id="result"></div>

<script>
const images = ["pamo1.jpg","pamo2.jpg","pamo3.jpg"];
const reelInners = document.querySelectorAll(".reel-inner");
const btn = document.getElementById("startBtn");
const resultDiv = document.getElementById("result");

let currentIndices = [0,0,0];

btn.addEventListener("click", () => {
    btn.disabled = true;
    resultDiv.textContent = "";

    const baseSpeed = 4; // é€šå¸¸å›è»¢é€Ÿåº¦(px/frame)
    const totalSpins = 50; // å›è»¢ãƒ•ãƒ¬ãƒ¼ãƒ æ•°
    const stopDelays = [0, 15, 30]; // å·¦â†’å³ã«é †ç•ªã«æ¸›é€Ÿé–‹å§‹

    let frame = 0;

    function animate(){
        reelInners.forEach((inner, i) => {
            // æ¸›é€Ÿã‚¿ã‚¤ãƒŸãƒ³ã‚°
            let speed = baseSpeed;
            if(frame > stopDelays[i]){
                const progress = Math.min((frame - stopDelays[i]) / 20, 1); // 0â†’1ã®å‰²åˆ
                speed = baseSpeed * (1 - progress*progress); // äºŒæ¬¡ã‚¤ãƒ¼ã‚¸ãƒ³ã‚°ã§æ»‘ã‚‰ã‹æ¸›é€Ÿ
            }

            // ç¾åœ¨ä½ç½®æ›´æ–°
            currentIndices[i] += speed/100; // 1ç”»åƒ=100px
            currentIndices[i] %= images.length;
            const translateY = Math.floor(currentIndices[i]*100);
            inner.style.transform = `translateY(-${translateY}px)`;
        });

        frame++;
        if(frame < totalSpins + stopDelays[2] + 20){ // å…¨ãƒªãƒ¼ãƒ«æ¸›é€Ÿå®Œäº†ã¾ã§
            requestAnimationFrame(animate);
        } else {
            // æœ€å¾Œã«ãƒ©ãƒ³ãƒ€ãƒ ã§æ­¢ã‚ã‚‹
            reelInners.forEach((inner, i) => {
                const finalIndex = Math.floor(Math.random()*images.length);
                currentIndices[i] = finalIndex;
                inner.style.transform = `translateY(-${finalIndex*100}px)`;
            });
            // å½“ãŸã‚Šåˆ¤å®š
            const first = currentIndices[0];
            const allSame = currentIndices.every(idx => idx === first);
            resultDiv.textContent = allSame ? "å½“ãŸã‚Šï¼ğŸ‰" : "ã¯ãšã‚Œâ€¦ğŸ˜¢";
            btn.disabled = false;
        }
    }

    animate();
});
</script>

</body>
</html>
